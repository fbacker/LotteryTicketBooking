!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){a(1),a(2),e.exports=a(6)},function(e,t){$(function(){var e=function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},t=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=a.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},a="admin"===t("blubb"),n=20,r=["red","blue","green"],i=null,s="<div data-id='#ID' data-category='#CATEGORY' class='line'><label><input type='checkbox' data-type='book' /> <span>Lott #ID</span></label></div>",o="<div><input type='checkbox' data-type='delete'><span>delete</span></input>&nbsp;&nbsp;&nbsp;<input type='checkbox' data-type='payed'><span>payed</span></input></div>";$("#btnSubmit").html("Uppdatera");var d=function(e,t){console.log("print",e,t);var a=e?"danger":"success",n='<div class="alert alert-'+a+' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t+"</div>";$("#alerts").append(n)},l=function(e){e.addClass("highlighted"),window.setTimeout(function(){e.removeClass("highlighted")},5e3)},p=function(){for(var e=0;e<r.length;e++)for(var t=$("#block-"+r[e]),i=1;i<=n;i++){var d=s.concat("");d=d.replace(/#ID/g,i),d=d.replace(/#CATEGORY/g,r[e]);var l=$(d).appendTo(t);if(a){var p=l.find("input");p.attr("disabled",!0),p.css("display","none"),l.addClass("lineadmin"),l.append(o)}}};$("#form").submit(function(t){t.preventDefault();var n=$("#email").val().toLowerCase(),r=$("#name").val().toLowerCase();if(r.length<2&&!a)return void d(!0,"Du måste fylla i ett namn.");if(!e(n)&&!a)return void d(!0,"Du måste ange din epost.");for(var i=$("#form").find("input[type=checkbox]"),s=[],o=0;o<i.length;o++){var l=i[o];if(a||l.checked&&!l.disabled){var p=$(l).parent().parent()[0];(a&&"book"!=l.dataset.type||!a)&&s.push({category:p.dataset.category,id:p.dataset.id,type:l.dataset.type,checked:l.checked})}}return 0===s.length?void d(!0,"Du har inte valt några lotter."):void $.ajax({type:"POST",url:"/api/add",dataType:"json",data:JSON.stringify({name:r,email:n,selected:s,bb:a}),contentType:"application/json"}).done(function(e){return a?void location.reload():(u(),void d(!1,"Grattis, du har bokat lotter. Glöm inte att betala in annars tas du bort."))}).fail(function(e,t,a){if(401===e.status)d(!0,"Du har valt lotter som redan är tagna. Försök igen.");else if(402===e.status)d(!0,"Du kan inte köpa fler lotter än maxgränsen.");else if(403===e.status){var n="";switch(e.responseText){case"red":n="Röd";break;case"green":n="Grön";break;case"blue":n="Blå"}d(!0,"Du kan inte köpa fler än maxgränsen utav lotter i serie "+n+".")}else 404===e.status&&d(!0,"Du kan inte köpa lott "+e.responseText+" då du redan har köpt den i en annan serie.");u()})});var c=function(e){for(var t=0;t<e.length;t++)for(var n=e[t],r=$("#block-"+n.category),i=r.children(),s=0;s<i.length;s++){var o=$(i[s])[0];if(o.dataset.id===n.id){var d=$(o).find("input");if(d.length>0&&(!d[0].disabled||a)){var p=n.id+": "+n.name;a&&(p+="<br />"+n.email),$($(o).find("span")[0]).html(p),$($(o).find("span")[0]).css("font-weight","400"),$(d[0]).attr("disabled",!0),$(d[0]).css("display","none"),a||l(d.parent().parent()),a&&$(d[2]).attr("checked",n.payed)}break}}},u=function(){$.getJSON("/api/list").done(function(e){c(e)}).fail(function(e,t,a){d(!0,"Kan inte läsa från servern, testa att ladda om sidan.")})};p(),i=setInterval(u,1e4),u()})},function(e,t){},,,,function(e,t){}]);