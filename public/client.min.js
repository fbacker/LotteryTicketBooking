!function(e){function a(n){if(t[n])return t[n].exports;var r=t[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}var t={};return a.m=e,a.c=t,a.p="",a(0)}([function(e,a,t){t(1),t(2),e.exports=t(6)},function(e,a){$(function(){var e=function(e){var a=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return a.test(e)},a=function(e,a){a||(a=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=t.exec(a);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},t="admin"===a("blubb"),n=50,r=["red","blue","green","yellow"],i=null,s="<div data-id='#ID' data-category='#CATEGORY' class='line'><label><input type='checkbox' data-type='book' /> <span>Lott #ID</span></label></div>",l="<div><input type='checkbox' data-type='delete'><span>delete</span></input>&nbsp;&nbsp;&nbsp;<input type='checkbox' data-type='payed'><span>payed</span></input></div>";t&&$("#btnSubmit").html("Uppdatera");var o=function(e,a){console.log("print",e,a);var t=e?"danger":"success",n='<div class="alert alert-'+t+' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+a+"</div>";$("#alerts").append(n)},d=function(e){e.addClass("highlighted"),window.setTimeout(function(){e.removeClass("highlighted")},5e3)},p=function(){for(var e=0;e<r.length;e++)for(var a=$("#block-"+r[e]),i=1;i<=n;i++){var o=s.concat("");o=o.replace(/#ID/g,i),o=o.replace(/#CATEGORY/g,r[e]);var d=$(o).appendTo(a);if(t){var p=d.find("input");p.attr("disabled",!0),p.css("display","none"),d.addClass("lineadmin"),d.append(l)}}};$("#form").submit(function(a){a.preventDefault();var n=$("#email").val().toLowerCase().trim(),r=$("#name").val().toLowerCase().trim();if(r.length<2&&!t)return void o(!0,"Du måste fylla i ett namn.");if(r.split(" ").length<2)return void o(!0,"Du måste fylla förnamn &amp; efternamn.");if(!e(n)&&!t)return void o(!0,"Du måste ange din epost.");for(var i=$("#form").find("input[type=checkbox]"),s=[],l=0;l<i.length;l++){var d=i[l];if(t||d.checked&&!d.disabled){var p=$(d).parent().parent()[0];(t&&"book"!=d.dataset.type||!t)&&s.push({category:p.dataset.category,id:p.dataset.id,type:d.dataset.type,checked:d.checked})}}return 0===s.length?void o(!0,"Du har inte valt några lotter."):void $.ajax({type:"POST",url:"/api/add",dataType:"json",data:JSON.stringify({name:r,email:n,selected:s,bb:t}),contentType:"application/json"}).done(function(e){return t?void location.reload():(u(),void o(!1,"Grattis, du har bokat lotter. Glöm inte att betala in annars tas du bort."))}).fail(function(e,a,t){if(401===e.status)o(!0,"Du har valt lotter som redan är tagna. Försök igen.");else if(402===e.status)o(!0,"Du kan inte köpa fler lotter än maxgränsen.");else if(403===e.status){var n="";switch(e.responseText){case"red":n="Röd";break;case"green":n="Grön";break;case"blue":n="Blå";break;case"yellow":n="Gul"}o(!0,"Du kan inte köpa fler än maxgränsen utav lotter i serie "+n+".")}else 404===e.status&&o(!0,"Du får inte köpa samma lottnr i olika serier.");u()})});var c=function(e){for(var a=0;a<e.length;a++)for(var n=e[a],r=$("#block-"+n.category),i=r.children(),s=0;s<i.length;s++){var l=$(i[s])[0];if(l.dataset.id===n.id){var o=$(l).find("input");if(o.length>0&&(!o[0].disabled||t)){var p=n.id+": "+n.name;n.payed&&(p+=" <i class='fa fa-euro' />"),t&&(p+="<br />"+n.email+"<br />"+n.date),$($(l).find("span")[0]).html(p),$($(l).find("span")[0]).css("font-weight","400"),$(o[0]).attr("disabled",!0),$(o[0]).css("display","none"),t||d(o.parent().parent()),t&&$(o[2]).attr("checked",n.payed)}break}}},u=function(){$.getJSON("/api/list").done(function(e){c(e)}).fail(function(e,a,t){o(!0,"Kan inte läsa från servern, testa att ladda om sidan.")})};p(),i=setInterval(u,1e4),u()})},function(e,a){},,,,function(e,a){}]);