!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){__webpack_require__(1),__webpack_require__(2),module.exports=__webpack_require__(6)},function(module,exports){$(function(){var validateEmail=function(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email)},getParameterByName=function(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},isAdmin="admin"===getParameterByName("blubb"),numOfTickets=50,bases=["red","blue","green","yellow","pink","orange"],updateInterval=null,displayItem="<div data-id='#ID' data-category='#CATEGORY' class='line'><label><input type='checkbox' data-type='book' /> <span>Lott #ID</span></label></div>",adminItem="<div><input type='checkbox' data-type='delete'><span>delete</span></input>&nbsp;&nbsp;&nbsp;<input type='checkbox' data-type='payed'><span>payed</span></input></div>";isAdmin&&$("#btnSubmit").html("Uppdatera");var print=function(error,message){console.log("print",error,message);var type=error?"danger":"success",messageout='<div class="alert alert-'+type+' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+message+"</div>";$("#alerts").append(messageout)},highlight=function(item){item.addClass("highlighted"),window.setTimeout(function(){item.removeClass("highlighted")},5e3)},build=function(){for(var i=0;i<bases.length;i++)for(var base=$("#block-"+bases[i]),j=1;j<=numOfTickets;j++){var strItem=displayItem.concat("");strItem=strItem.replace(/#ID/g,j),strItem=strItem.replace(/#CATEGORY/g,bases[i]);var item=$(strItem).appendTo(base);if(isAdmin){var input=item.find("input");input.attr("disabled",!0),input.css("display","none"),item.addClass("lineadmin"),item.append(adminItem)}}};$("#form").submit(function(event){event.preventDefault();var email=$("#email").val().toLowerCase().trim(),name=$("#name").val().toLowerCase().trim();if(name.length<2&&!isAdmin)return void print(!0,"Du måste fylla i ett namn.");if(name.split(" ").length<2&&!isAdmin)return void print(!0,"Du måste fylla förnamn &amp; efternamn.");if(!validateEmail(email)&&!isAdmin)return void print(!0,"Du måste ange din epost.");for(var inputs=$("#form").find("input[type=checkbox]"),selected=[],i=0;i<inputs.length;i++){var input=inputs[i];if(isAdmin||input.checked&&!input.disabled){var p=$(input).parent().parent()[0];(isAdmin&&"book"!=input.dataset.type||!isAdmin)&&selected.push({category:p.dataset.category,id:p.dataset.id,type:input.dataset.type,checked:input.checked})}}return 0===selected.length?void print(!0,"Du har inte valt några lotter."):void $.ajax({type:"POST",url:"/api/add",dataType:"json",data:JSON.stringify({name:name,email:email,selected:selected,bb:isAdmin}),contentType:"application/json"}).done(function(json){return isAdmin?void location.reload():(load(),void print(!1,"Grattis, du har bokat lotter. Glöm inte att betala in annars tas du bort."))}).fail(function(jqxhr,textStatus,error){if(401===jqxhr.status)print(!0,"Du har valt lotter som redan är tagna. Försök igen.");else if(402===jqxhr.status)print(!0,"Du kan inte köpa fler lotter än maxgränsen.");else if(403===jqxhr.status){var tout="";switch(jqxhr.responseText){case"red":tout="Röd";break;case"green":tout="Grön";break;case"blue":tout="Blå";break;case"yellow":tout="Gul"}print(!0,"Du kan inte köpa fler än maxgränsen utav lotter i serie "+tout+".")}else 404===jqxhr.status&&print(!0,"Du får inte köpa samma lottnr i olika serier.");load()})});var update=function(data){for(var i=0;i<data.length;i++)for(var item=data[i],container=$("#block-"+item.category),children=container.children(),j=0;j<children.length;j++){var $currentElement=$(children[j])[0];if($currentElement.dataset.id===item.id){var input=$($currentElement).find("input");if(input.length>0&&(!input[0].disabled||isAdmin)){var name=item.id+": "+item.name;item.payed&&(name+=" <i class='fa fa-euro' />"),isAdmin&&(name+="<br />"+item.email+"<br />"+item.date),$($($currentElement).find("span")[0]).html(name),$($($currentElement).find("span")[0]).css("font-weight","400"),$(input[0]).attr("disabled",!0),$(input[0]).css("display","none"),isAdmin||highlight(input.parent().parent()),isAdmin&&$(input[2]).attr("checked",item.payed)}break}}},load=function(){$.getJSON("/api/list").done(function(json){update(json)}).fail(function(jqxhr,textStatus,error){print(!0,"Kan inte läsa från servern, testa att ladda om sidan.")})};build(),updateInterval=setInterval(load,1e4),load()})},function(module,exports){},,,,function(module,exports){}]);